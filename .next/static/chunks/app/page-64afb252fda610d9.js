(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7570:(e,t,a)=>{Promise.resolve().then(a.bind(a,8879))},8879:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var s=a(5155),o=a(2115),r=a(1512),n=a.n(r);let l=e=>{let[t,a]=(0,o.useState)({driver_name:"",vehicle_id:"",current_location:"",pickup_location:"",dropoff_location:"",current_cycle_used:""}),r=e=>{a({...t,[e.target.name]:e.target.value})},l=async a=>{a.preventDefault(),e.onSubmit&&e.onSubmit(t.current_location,t.pickup_location,t.dropoff_location,t.driver_name,t.vehicle_id,t.current_cycle_used)};return(0,s.jsxs)("form",{onSubmit:l,className:n().form,children:[(0,s.jsxs)("div",{className:n().headingCont,children:[(0,s.jsx)("h1",{className:n().heading,children:"Trip Details"}),(0,s.jsx)("p",{className:n().subHeading,children:"Enter your trip information below"})]}),(0,s.jsxs)("div",{className:n().row,children:[(0,s.jsx)("label",{htmlFor:"driver_name",className:n().label,children:"Driver Name"}),(0,s.jsx)("input",{name:"driver_name",placeholder:"Enter Driver Name",onChange:r,className:n().inputStyle})]}),(0,s.jsxs)("div",{className:n().row,children:[(0,s.jsx)("label",{htmlFor:"vehicle_id",className:n().label,children:"Vehicle ID"}),(0,s.jsx)("input",{name:"vehicle_id",placeholder:"Enter Vehicle ID",onChange:r,className:n().inputStyle})]}),(0,s.jsxs)("div",{className:n().row,children:[(0,s.jsx)("label",{htmlFor:"current_location",className:n().label,children:"Current Location"}),(0,s.jsx)("input",{name:"current_location",placeholder:"Enter city, state or address",onChange:r,className:n().inputStyle})]}),(0,s.jsxs)("div",{className:n().row,children:[(0,s.jsx)("label",{htmlFor:"pickup_location",className:n().label,children:"Pickup Location"}),(0,s.jsx)("input",{name:"pickup_location",placeholder:"Enter city, state or address",onChange:r,className:n().inputStyle})]}),(0,s.jsxs)("div",{className:n().row,children:[(0,s.jsx)("label",{htmlFor:"dropoff_location",className:n().label,children:"Dropoff Location"}),(0,s.jsx)("input",{name:"dropoff_location",placeholder:"Enter city, state or address",onChange:r,className:n().inputStyle})]}),(0,s.jsxs)("div",{className:n().row,children:[(0,s.jsx)("label",{htmlFor:"current_cycle_used",className:n().label,children:"Current Cycle Hours Used"}),(0,s.jsx)("input",{name:"current_cycle_used",placeholder:"Hours Used",type:"number",onChange:r,className:n().inputStyle})]}),(0,s.jsx)("button",{type:"submit",className:n().button,children:"Submit"})]})};var i=a(9990),c=a.n(i);a(8689);var d=a(8776),_=a.n(d),u=a(2651),m=a(2818);let h=e=>{let{loc1:t,loc2:a,loc3:r}=e,n=(0,o.useRef)(null),l=(0,o.useRef)(null),i=(0,o.useRef)([]),d=m.env.NEXT_PUBLIC_MAP_BOX_API;(0,o.useEffect)(()=>{if(c().accessToken=d,!n.current)return;let e=new(c()).Map({container:n.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-98.5795,39.8283],zoom:3,projection:"globe"});return e.on("style.load",()=>{e.setFog({})}),l.current=e,()=>e.remove()},[d]);let h=async(e,t,a)=>{if(!l.current)return;let s=l.current,o=[e,t,a].map(e=>e.join(",")).join(";");try{let r=await u.A.get("https://api.mapbox.com/directions/v5/mapbox/driving/".concat(o),{params:{access_token:c().accessToken,overview:"full",geometries:"geojson"}});if(!r.data.routes||0===r.data.routes.length){console.log("No route found");return}let n=r.data.routes[0].geometry,l={type:"FeatureCollection",features:[{type:"Feature",geometry:n,properties:{}}]},d=s.getSource("route");d?d.setData(l):(s.addSource("route",{type:"geojson",data:l}),s.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#4264fb","line-width":5}})),i.current.forEach(e=>e.remove()),i.current=[],[e,t,a].forEach((e,t)=>{let a=new(c()).Marker({color:0===t?"#00ffcc":2===t?"#ff3366":"#ffcc00"}).setLngLat(e).addTo(s);i.current.push(a)})}catch(e){console.error("Error fetching route:",e)}};return(0,o.useEffect)(()=>{t&&a&&r&&t.every(e=>"number"==typeof e)&&a.every(e=>"number"==typeof e)&&r.every(e=>"number"==typeof e)&&h(t,a,r)},[t,a,r]),(0,s.jsx)("div",{className:_().container,children:(0,s.jsx)("div",{ref:n,style:{width:"100%",height:"100%"}})})};var p=a(5748),g=a.n(p),x=a(5629),v=a.n(x);let j=e=>(0,s.jsxs)("div",{className:"".concat(v().logCont," ").concat(!e.isLast&&v().logConstUnderline),children:[(0,s.jsxs)("div",{className:v().left,children:[(0,s.jsx)("p",{className:v().time,children:e.time}),(0,s.jsx)("p",{className:v().duty,children:e.status})]}),(0,s.jsxs)("div",{className:v().right,children:[(0,s.jsx)("p",{className:v().action,children:e.remarks}),(0,s.jsxs)("p",{className:v().odometer,children:["Odometer: ",e.odometer," mi"]})]})]}),N=e=>(0,s.jsxs)("div",{className:v().mainCont,children:[(0,s.jsxs)("div",{className:v().topCont,children:[(0,s.jsxs)("div",{className:v().col,children:[(0,s.jsxs)("div",{className:v().textsCont,children:[(0,s.jsx)("p",{className:v().title,children:"Driver Name"}),(0,s.jsx)("p",{className:v().info,children:e.name})]}),(0,s.jsxs)("div",{className:v().textsCont,children:[(0,s.jsx)("p",{className:v().title,children:"Date"}),(0,s.jsx)("p",{className:v().info,children:e.date})]})]}),(0,s.jsxs)("div",{className:v().col,children:[(0,s.jsxs)("div",{className:v().textsCont,children:[(0,s.jsx)("p",{className:v().title,children:"Vehicle ID"}),(0,s.jsx)("p",{className:v().info,children:e.vehicleId})]}),(0,s.jsxs)("div",{className:v().textsCont,children:[(0,s.jsx)("p",{className:v().title,children:"Remaining Hours"}),(0,s.jsx)("p",{className:v().info,children:e.remainingHours})]})]})]}),(0,s.jsxs)("div",{className:v().subCont,children:[(0,s.jsx)("p",{className:v().title,children:"Hours Summary"}),(0,s.jsxs)("div",{className:v().hoursCont,children:[(0,s.jsxs)("div",{className:v().hoursSubCont,children:[(0,s.jsx)("p",{className:v().totalHours,children:"Total Driving Hours:"}),(0,s.jsx)("p",{className:v().hoursText,children:e.totalDrivingHours})]}),(0,s.jsxs)("div",{className:v().hoursSubCont,children:[(0,s.jsx)("p",{className:v().totalHours,children:"Total On Duty Hours:"}),(0,s.jsx)("p",{className:v().hoursText,children:e.totalOnDutyHours})]})]})]}),(0,s.jsxs)("div",{className:v().subCont,children:[(0,s.jsx)("p",{className:v().title,children:"Log Entries"}),(0,s.jsx)("div",{className:v().dataCont,children:e.logs.map((t,a)=>(0,s.jsx)(j,{remarks:t.remarks,odometer:t.odometer,time:t.time,status:t.status,isLast:a==e.logs.length-1},a))})]})]}),f=e=>(0,s.jsxs)("div",{className:g().container,children:[(0,s.jsxs)("div",{className:g().headingCont,children:[(0,s.jsx)("h1",{className:g().heading,children:"ELD Logs"}),(0,s.jsx)("p",{className:g().subHeading,children:"Generated log sheets for your trip"})]}),e.logs.length?(0,s.jsx)(N,{logs:e.logs,date:e.date,name:e.name,remainingHours:e.remainingHours,totalDrivingHours:e.totalDrivingHours,totalOnDutyHours:e.totalOnDutyHours,vehicleId:e.vehicleId}):(0,s.jsx)("div",{className:g().eldPlaceHolder,children:(0,s.jsx)("p",{children:"Log sheets will appear here after route calculation"})})]});var y=a(5717),C=a.n(y),b=a(2818);function E(){let[e,t]=(0,o.useState)([[0,0],[0,0],[0,0]]),[a,r]=(0,o.useState)({date:"",driver_name:"",vehicle_id:"",remaining_hours:"",total_driving_hours:"",total_on_duty_hours:""}),[n,i]=(0,o.useState)([]),c=b.env.NEXT_PUBLIC_MAP_BOX_API,d=async e=>{try{let t=await u.A.get("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(encodeURIComponent(e),".json"),{params:{access_token:c,limit:1}});if(!(t.data.features.length>0))return console.error("No location found for",e),null;{let[e,a]=t.data.features[0].center;return[e,a]}}catch(e){return console.error("Error fetching coordinates:",e),null}},_=async(e,t,a,s,o,n)=>{try{let l=await u.A.post("https://eld-backend-production.up.railway.app/api/trips/",{driver_name:e,vehicle_id:t,current_location:a,pickup_location:s,dropoff_location:o,cycle_used:n});r({date:l.data.date,driver_name:l.data.driver_name,vehicle_id:l.data.vehicle_id,remaining_hours:l.data.remaining_hours,total_driving_hours:l.data.hours_summary.total_driving_hours,total_on_duty_hours:l.data.hours_summary.total_on_duty_hours}),i(l.data.daily_logs[0])}catch(e){console.log(e)}};return(0,s.jsxs)("div",{className:C().mainCont,children:[(0,s.jsxs)("div",{className:C().topCont,children:[(0,s.jsx)(l,{onSubmit:async(e,a,s,o,r,n)=>{let l=await d(e),i=await d(a),c=await d(s);_(o,r,e,a,s,+n),t([l,i,c])}}),(0,s.jsx)(h,{loc1:e[0],loc2:e[1],loc3:e[2]})]}),(0,s.jsx)(f,{date:a.date,logs:n,name:a.driver_name,remainingHours:a.remaining_hours,totalDrivingHours:a.total_driving_hours,totalOnDutyHours:a.total_on_duty_hours,vehicleId:a.vehicle_id})]})}},5717:e=>{e.exports={mainCont:"page_mainCont__aqTyA",topCont:"page_topCont__x_lbQ"}},5629:e=>{e.exports={mainCont:"EldLog_mainCont__RNGsE",topCont:"EldLog_topCont__kDTWD",col:"EldLog_col__o9J8D",textsCont:"EldLog_textsCont__vd6Sk",info:"EldLog_info__EIgHo",title:"EldLog_title__0S_18",subCont:"EldLog_subCont__Tsg1w",hoursCont:"EldLog_hoursCont__cf83H",hoursSubCont:"EldLog_hoursSubCont__KHpHE",totalHours:"EldLog_totalHours__Ly2gE",hoursText:"EldLog_hoursText__YeGSm",logCont:"EldLog_logCont__E7kS_",left:"EldLog_left__Ni65Z",time:"EldLog_time__emkgz",duty:"EldLog_duty__qXkli",right:"EldLog_right__SGXSh",action:"EldLog_action__Fw1KG",odometer:"EldLog_odometer__YIFlA",logConstUnderline:"EldLog_logConstUnderline__5hDoX",dataCont:"EldLog_dataCont__7g__c"}},5748:e=>{e.exports={container:"EldLogs_container__ZfIb6",headingCont:"EldLogs_headingCont__0UrTu",heading:"EldLogs_heading__SS1xH",subHeading:"EldLogs_subHeading__Ppc5z",eldPlaceHolder:"EldLogs_eldPlaceHolder__8wM7L"}},8776:e=>{e.exports={container:"Map_container__lWlzA",headingCont:"Map_headingCont__GvVQ9",heading:"Map_heading___HK4t",subHeading:"Map_subHeading__zFijK"}},1512:e=>{e.exports={form:"TripForm_form__CBofo",inputStyle:"TripForm_inputStyle__NgvFn",button:"TripForm_button__NAc_L",heading:"TripForm_heading__nOA5h",subHeading:"TripForm_subHeading__6x_Kp",label:"TripForm_label__X7D_6",row:"TripForm_row__BozjX",headingCont:"TripForm_headingCont__3PpfU"}}},e=>{var t=t=>e(e.s=t);e.O(0,[400,240,75,441,517,358],()=>t(7570)),_N_E=e.O()}]);